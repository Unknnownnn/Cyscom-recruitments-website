<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Basic Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://unpkg.com https://www.gstatic.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data: https:; connect-src 'self' https://*.googleapis.com https://*.firebaseio.com https://ipapi.co; font-src 'self' https://cdn.jsdelivr.net;">
    
    <title>Cyscom Recuitments 2025</title>
    <link rel="shortcut icon" href="https://twogood.com.au/favicon-32x32.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/locomotive-scroll@3.5.4/dist/locomotive-scroll.css">
    
    <!-- React and Babel CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase Configuration (load environment first, then config) -->
    <script src="firebase-env.js"></script>
    <script src="firebase-config.js"></script>
    
    <!-- Security Utilities -->
    <script src="security-utils.js"></script>
    
</head>

<body>
    <div id="nav">
        <div id="nav-part1">
            <img src="Images/logo.png" alt="Logo" style="height: 80px;">
        </div>
        <div id="nav-part2">
            <div id="links">
                <a href="#page1" id="home-link">HOME</a>
                <a href="#moto" id="about-link">ABOUT</a>
                <a href="#page2" id="register-link">DEPARTMENTS</a>
                <a href="#page4" id="recruitment-link">APPLY NOW</a>
                <a href="#impact" id="results-link">RESULTS</a>
            </div>
        </div>
    </div>
    <div id="cursor"></div>
    <div id="main">
    <div id="page1">

            <div class="top-spacer"></div>
            <h1 class="main-title">CYSCOM</h1>
            <h1 class="main-title">RECRUITMENTS</h1>
            <h1 class="year-title">2025</h1>
            <div class="bottom-spacer"></div>
            <div id="video-container">
                <div id="play">PLAY</div>
                <video start="98" autoplay muted loop src="./video.mp4#t=98"></video>
            </div>
        </div>
        <div id="page2">
            <div id="slider-container">
                <button id="prev-btn" class="slider-nav">
                    <i class="ri-arrow-left-s-line"></i>
                </button>
                <div id="slider-wrapper">
                    <div id="elem1" class="elem">
                        <img data-scroll data-scroll-speed="1"
                            src="Images\Tech.png"
                            alt="" style="width:280px; height:auto;">
                        <div data-scroll data-scroll-speed="-2" class="dets">
                            <div class="dets-info" style="background-color: #013066;">
                                <i class="ri-circle-fill"></i>
                                <p><b>TECHNICAL</b></p>
                                <i class="ri-arrow-right-s-line"></i>
                            </div>
                            <div class="container" style="background-color: #06b1bd;">
                                <div class="listing">
                                    <div class="list-elem">
                                        <p>CYSCOM RECRUITMENTS</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="elem2" class="elem">
                        <img data-scroll data-scroll-speed="1"
                            src="Images\Design.png"
                            alt="" style="width:420px; height:auto;">
                        <div data-scroll data-scroll-speed="-2" class="dets">
                            <div class="dets-info" style="background-color: #0484ac;">
                                <i class="ri-circle-fill"></i>
                                <p><b>DESIGN</b></p>
                                <i class="ri-arrow-right-s-line"></i>
                            </div>
                            <div class="container" style="background-color: #06b1bd;">
                                <div class="listing">
                                    <div class="list-elem">
                                        <p>CYSCOM RECRUITMENTS</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="elem3" class="elem">
                        <img data-scroll data-scroll-speed="1"
                            src="Images\dEV.png"
                            alt="" style="width:250px; height:auto;">
                        <div data-scroll data-scroll-speed="-2" class="dets">
                            <div class="dets-info" style="background-color: #040277;">
                                <i class="ri-circle-fill"></i>
                                <p><b>DEV</b></p>
                                <i class="ri-arrow-right-s-line"></i>
                            </div>
                            <div class="container" style="background-color: #0484ac;">
                                <div class="listing">
                                    <div class="list-elem">
                                        <p>CYSCOM RECRUITMENTS</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="elem4" class="elem">
                        <img data-scroll data-scroll-speed="1"
                            src="Images\SM.png"
                            alt="" style="width:320px; height:auto;">
                        <div data-scroll data-scroll-speed="-2" class="dets">
                            <div class="dets-info" style="background-color: #2c4cb8;">
                                <i class="ri-circle-fill"></i>
                                <p><b>SOCIAL MEDIA</b></p>
                                <i class="ri-arrow-right-s-line"></i>
                            </div>
                            <div class="container" style="background-color: #0484ac;">
                                <div class="listing">
                                    <div class="list-elem">
                                        <p>ETHICAL HACKING</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="elem5" class="elem">
                        <img data-scroll data-scroll-speed="1"
                            src="Images\Content.png"
                            alt="" style="width:250px; height:auto;">
                        <div data-scroll data-scroll-speed="-2" class="dets">
                            <div class="dets-info" style="background-color: #37288a;">
                                <i class="ri-circle-fill"></i>
                                <p><b>CONTENT</b></p>
                                <i class="ri-arrow-right-s-line"></i>
                            </div>
                            <div class="container" style="background-color: #0484ac;">
                                <div class="listing">
                                    <div class="list-elem">
                                        <p>NETWORK SECURITY</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="elem6" class="elem">
                        <img data-scroll data-scroll-speed="1"
                            src="Images\EM.png"
                            alt="" style="width:250px; height:auto;">
                        <div data-scroll data-scroll-speed="-2" class="dets">
                            <div class="dets-info" style="background-color: #3e0699;">
                                <i class="ri-circle-fill"></i>
                                <p><b>EVENT MANAGEMENT</b></p>
                                <i class="ri-arrow-right-s-line"></i>
                            </div>
                            <div class="container" style="background-color: #0484ac;">
                                <div class="listing">
                                    <div class="list-elem">
                                        <p>MALWARE ANALYSIS</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button id="next-btn" class="slider-nav">
                    <i class="ri-arrow-right-s-line"></i>
                </button>
            </div>
        </div>
        <div id="moto">
            <h2>THE BEST CYBERSECUIRTY CLUB IN VIT CHENNAI.</h2>
            <div class="para">
                <p>The Cybersecurity Student Community (CYSCOM) was formed in 2022 and ever since it has had one aim only, spreading awareness about cyber security and malware as well as ransomware threats in society and circles of students and teaching them how to deploy counter measures through various events and undertakings</p>
            </div>
        </div>
        <div id="page3">
            <div class="child" id="child1" data-color="#D4D0D3">
                <img src="https://cdn.sanity.io/images/w8f1ak3c/production/d6a2a4be8e3063d64648773f57f5f447609a93ab-5000x5000.png/Love-Care-Pack-Expanded-Two-Good-Co.png?w=1024&h=1024&auto=format"
                    alt="">
                <div class="childInfo">
                    <a href="#">the love + care pack</a>
                    <a href="#">$50</a>
                </div>
            </div>
            <div class="child" id="child2" data-color="#E6DFD7">
                <img src="https://cdn.sanity.io/images/w8f1ak3c/production/7a2007de38624a0b2935416bf51a4584889aa232-5000x5000.png/Website%20Products%20(12).png?w=1024&h=1024&auto=format"
                    alt="">
                <div class="childInfo">
                    <a href="#">two good tote bag</a>
                    <a href="#">$40</a>
                </div>
            </div>
            <div class="child" id="child3" data-color="#E6DFD7">
                <img src="https://cdn.sanity.io/images/w8f1ak3c/production/99866b12faf44f7490e6037dc197947334ce0a72-1408x1408.png/Nourish%20&%20Soothe%20Hand%20Lotion%20Two%20Good%20Co.png?w=1024&h=1024&auto=format"
                    alt="">
                <div class="childInfo">
                    <a href="#">nourish & soothe hand lotion</a>
                    <a href="#">$38</a>
                </div>
            </div>
            <div class="child" id="child4" data-color="#B4D5B6">
                <img src="https://cdn.sanity.io/images/w8f1ak3c/production/02240d01db2e8bdc5c630e9832ff7e0c7614f733-1876x1876.png/Cookbook-Two-Recipes-For-Resilience-Two-Good-Co.png?w=1024&h=1024&auto=format"
                    alt="">
                <div class="childInfo">
                    <a href="#">cookbook two</a>
                    <a href="#">$45</a>
                </div>
            </div>
        </div>
        <div id="page4">
            <div id="recruitment-section">
                <div id="recruitment-header">
                    <h2>JOIN CYSCOM</h2>
                    <h3>Apply to Become Part of Our Cybersecurity Community</h3>
                    <p>Choose your department and submit your application to join CYSCOM's mission of spreading cybersecurity awareness.</p>
                </div>
                
                <!-- Recruitment Form -->
                <div id="recruitment-form-container">
                    <form id="recruitment-form">
                        <!-- Personal Information Section -->
                        <div class="form-section">
                            <!-- <h4>Personal Information</h4> -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="firstName">First Name <span class="required">*</span></label>
                                    <input type="text" id="firstName" name="firstName" required>
                                </div>
                                <div class="form-group">
                                    <label for="lastName">Last Name <span class="required">*</span></label>
                                    <input type="text" id="lastName" name="lastName" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="email">Email Address <span class="required">*</span></label>
                                    <input type="email" id="email" name="email" required>
                                </div>
                                <div class="form-group">
                                    <label for="phone">Phone Number <span class="required">*</span></label>
                                    <input type="tel" id="phone" name="phone" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="regNumber">Registration Number <span class="required">*</span></label>
                                    <input type="text" id="regNumber" name="regNumber" required>
                                </div>
                                <div class="form-group">
                                    <label for="year">Academic Year <span class="required">*</span></label>
                                    <select id="year" name="year" required>
                                        <option value="" style="color:black">Select Year</option>
                                        <option value="1st" style="color:black">1st Year</option>
                                        <option value="2nd" style="color:black">2nd Year</option>
                                        <option value="3rd" style="color:black">3rd Year</option>
                                        <option value="4th" style="color:black">4th Year</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Honeypot field for bot protection (hidden) -->
                        <div style="position: absolute; left: -9999px; visibility: hidden;">
                            <input type="text" name="website" tabindex="-1" autocomplete="off" />
                        </div>

                        <!-- Department Selection -->
                        <div class="form-section">
                            <h4>Choose Your Departments</h4>
                            <p style="color: #666; font-size: 0.9rem; margin-bottom: 20px;">Select your 1st and 2nd preference departments.<br/> You can switch between preferences using the toggle buttons.</p>
                            <div id="animated-department-selector"></div>
                            <!-- Hidden inputs to store selected departments -->
                            <input type="hidden" id="department-primary" name="departmentPrimary" required>
                            <input type="hidden" id="department-secondary" name="departmentSecondary">
                        </div>

                        <!-- Skills and Experience -->
                        <div class="form-section">
                            <!-- <h4>Skills & Experience</h4> -->
                            <div class="form-group">
                                <label for="skills">Relevant Skills <span class="required">*</span></label>
                                <textarea id="skills" name="skills" placeholder="List your relevant skills, technologies, tools, or experience..." required></textarea>
                            </div>
                        </div>

                        <!-- Motivation -->
                        <div class="form-section">
                            <h4>Tell Us About Yourself</h4>
                            <div class="form-group">
                                <label for="motivation">Why do you want to join CYSCOM? <span class="required">*</span></label>
                                <textarea id="motivation" name="motivation" placeholder="Tell us why you're interested in cybersecurity and what motivates you to join CYSCOM..." required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="contribution">How can you contribute to CYSCOM?</label>
                                <textarea id="contribution" name="contribution" placeholder="Describe how you can contribute to our community and what unique value you bring..."></textarea>
                            </div>
                        </div>


                        <div class="form-actions">
                            <button type="submit" id="submit-btn" class="submit-button">
                                <span class="btn-text">Submit Application</span>
                                <span class="loading-spinner" style="display: none;">
                                    <i class="ri-loader-4-line"></i>
                                </span>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Success/Error Messages -->
                <div id="form-messages" style="display: none;">
                    <div id="success-message" class="message success-msg" style="display: none;">
                        <h4>Application Submitted Successfully!</h4>
                        <p>Thank you for your interest in CYSCOM. We'll review your application and get back to you soon.</p>
                    </div>
                    
                    <div id="error-message" class="message error-msg" style="display: none;">
                        <h4>Submission Failed</h4>
                        <p>There was an error submitting your application. Please try again.</p>
                    </div>
                </div>
            </div>
            <hr>
        </div>
        <div id="page5">
            <div id="footer">
                <div id="connect">
                    <p>CONNECT WITH US</p>
                    <a href="#">Facebook</a>
                    <a href="#">Instagram</a>
                    <a href="#">Twitter</a>
                    <a href="#">LinkedIn</a>
                    <a href="#">YouTube</a>
                </div>
                <div id="logo">
                    <img src="./logo.png" alt="">
                    <div id="copyright">
                        <a href="#">&copy; CYSCOM</a>
                        <a href="#">RECOGNIZED BY AICTE, Govt. Of INDIA</a>
                        <a href="#">VIT CHENNAI</a>
                    </div>
                </div>
                <div id="nitty">
                    <p>THE NITTY GRITTIES</p>
                    <a href="#">Good Things FAQs</a>
                    <a href="#">Good Food FAQs</a>
                    <a href="#">Good Places</a>
                    <a href="#">Pathways</a>
                    <a href="#">Careers</a>
                </div>
            </div>
            <div id="footer-info">
                <p>We are proud and privileged to have our home on this land, and to be able to continue the long
                    tradition of community coming together around food, begun thousands of years ago by First Nations
                    peoples. As we stand together on this unceded land, we acknowledge our First Nations people, are the
                    original custodians of this land, and we recognise their deep connection to land, water, sky and
                    community which continues today. We pay our deep respects to community elders, past, present and
                    emerging, for they hold the memories, the traditions, the culture and hopes of Aboriginal and Torres
                    Strait Islander peoples. Always was, always will be Aboriginal land.</p>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@3.5.4/dist/locomotive-scroll.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"
        integrity="sha512-16esztaSRplJROstbIIdwX3N97V1+pZvV33ABoG1H2OyTttBxEGkTsoIVsiP1iaTtM8b3+hu2kB6pQ4Clr5yug=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"
        integrity="sha512-Ic9xkERjyZ1xgJ5svx3y0u3xrvfT/uPkV99LBwe68xjy/mGtO+4eURHZBW2xW4SZbFrF1Tf090XqB+EVgXnVjw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="app.js"></script>
    <script type="text/babel" src="react-components.js"></script>
    <script type="text/babel" src="react-enhanced.js"></script>
    <script type="text/babel" src="animated-department-selector.js"></script>
    <script>
        // Force page to top on refresh/load
        window.addEventListener('beforeunload', function() {
            window.scrollTo(0, 0);
        });
        
        // Also ensure we're at top when page loads
        window.addEventListener('load', function() {
            setTimeout(function() {
                window.scrollTo(0, 0);
            }, 100);
        });

        // Smooth scrolling for navigation links
        document.addEventListener('DOMContentLoaded', function() {
            // Force scroll to top immediately
            window.scrollTo(0, 0);
            
            // Get all navigation links
            const homeLink = document.getElementById('home-link');
            const aboutLink = document.getElementById('about-link');
            const registerLink = document.getElementById('register-link');
            const recruitmentLink = document.getElementById('recruitment-link');
            const resultsLink = document.getElementById('results-link');

            // Add smooth scroll behavior
            function smoothScrollTo(targetId) {
                const target = document.getElementById(targetId);
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start',
                        inline: 'nearest'
                    });
                }
            }

            // Multiple methods for scrolling to top (for better compatibility)
            function scrollToTop() {
                // Method 1: window.scrollTo
                window.scrollTo({
                    top: 0,
                    left: 0,
                    behavior: 'smooth'
                });
                
                // Method 2: Fallback for older browsers
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
            }

            // Add event listeners with null checks
            if (homeLink) {
                homeLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    scrollToTop();
                });
            }

            if (aboutLink) {
                aboutLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    smoothScrollTo('moto');
                });
            }

            if (registerLink) {
                registerLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    smoothScrollTo('page2');
                });
            }

            if (recruitmentLink) {
                recruitmentLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    smoothScrollTo('page4');
                });
            }

            if (resultsLink) {
                resultsLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    smoothScrollTo('impact');
                });
            }

            // Slider functionality
            const slider = document.getElementById('slider-wrapper');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const slides = document.querySelectorAll('#page2 .elem');
            
            let currentIndex = 0;
            const slideWidth = 440; // 400px width + 40px margins
            const totalSlides = slides.length; // Total number of slides (6)
            const maxIndex = totalSlides - 1; // Maximum index (5 for 6 slides)

            console.log('Total slides found:', totalSlides); // Debug info

            function updateSlider() {
                // Calculate the translate value
                const translateX = -currentIndex * slideWidth;
                slider.style.transform = `translateX(${translateX}px)`;
                
                // Update slide indicator
                const currentSlideSpan = document.getElementById('current-slide');
                if (currentSlideSpan) {
                    currentSlideSpan.textContent = currentIndex + 1;
                }
                
                console.log('Current index:', currentIndex, 'Max index:', maxIndex); // Debug info
                
                // Update button states
                prevBtn.style.opacity = currentIndex === 0 ? '0.3' : '1';
                prevBtn.style.pointerEvents = currentIndex === 0 ? 'none' : 'auto';
                
                nextBtn.style.opacity = currentIndex >= maxIndex ? '0.3' : '1';
                nextBtn.style.pointerEvents = currentIndex >= maxIndex ? 'none' : 'auto';
                
                // Add visual feedback for button states
                if (currentIndex === 0) {
                    prevBtn.style.transform = 'translateY(-50%) scale(0.9)';
                } else {
                    prevBtn.style.transform = 'translateY(-50%) scale(1)';
                }
                
                if (currentIndex >= maxIndex) {
                    nextBtn.style.transform = 'translateY(-50%) scale(0.9)';
                } else {
                    nextBtn.style.transform = 'translateY(-50%) scale(1)';
                }
            }

            function nextSlide() {
                console.log('Next clicked, current:', currentIndex, 'max:', maxIndex); // Debug info
                if (currentIndex < maxIndex) {
                    currentIndex++;
                    updateSlider();
                }
            }

            function prevSlide() {
                console.log('Prev clicked, current:', currentIndex); // Debug info
                if (currentIndex > 0) {
                    currentIndex--;
                    updateSlider();
                }
            }

            // Add event listeners for slider buttons
            if (nextBtn) {
                nextBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    nextSlide();
                });
            }
            
            if (prevBtn) {
                prevBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    prevSlide();
                });
            }

            // Initialize slider
            updateSlider();

            // Enhanced keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'ArrowRight' || e.key === 'Right') {
                    e.preventDefault();
                    nextSlide();
                } else if (e.key === 'ArrowLeft' || e.key === 'Left') {
                    e.preventDefault();
                    prevSlide();
                } else if (e.key === 'Home') {
                    e.preventDefault();
                    currentIndex = 0;
                    updateSlider();
                } else if (e.key === 'End') {
                    e.preventDefault();
                    currentIndex = maxIndex;
                    updateSlider();
                }
            });

            // Enhanced touch/swipe support for mobile
            let startX = 0;
            let isDragging = false;

            slider.addEventListener('touchstart', function(e) {
                startX = e.touches[0].clientX;
                isDragging = true;
                slider.style.transition = 'none';
            }, { passive: true });

            slider.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                
                const currentX = e.touches[0].clientX;
                const diffX = startX - currentX;
                const currentTranslate = -currentIndex * slideWidth;
                
                // Add resistance at boundaries
                let newTranslate = currentTranslate - diffX;
                if (currentIndex === 0 && diffX < 0) {
                    newTranslate = currentTranslate - (diffX * 0.3);
                } else if (currentIndex >= maxIndex && diffX > 0) {
                    newTranslate = currentTranslate - (diffX * 0.3);
                }
                
                slider.style.transform = `translateX(${newTranslate}px)`;
            }, { passive: true });

            slider.addEventListener('touchend', function(e) {
                if (!isDragging) return;
                
                const endX = e.changedTouches[0].clientX;
                const diffX = startX - endX;
                
                // Restore transition
                slider.style.transition = 'transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                
                // Determine if it's a swipe based on distance
                if (Math.abs(diffX) > 50) {
                    if (diffX > 0) {
                        nextSlide();
                    } else {
                        prevSlide();
                    }
                } else {
                    // Snap back to current position
                    updateSlider();
                }
                
                isDragging = false;
            }, { passive: true });

            // Recruitment Form Handling
            const recruitmentForm = document.getElementById('recruitment-form');
            const submitBtn = document.getElementById('submit-btn');
            const btnText = document.querySelector('.btn-text');
            const loadingSpinner = document.querySelector('.loading-spinner');
            const formMessages = document.getElementById('form-messages');
            const successMessage = document.getElementById('success-message');
            const errorMessage = document.getElementById('error-message');

            // Form validation and security
            function sanitizeInput(str) {
                const div = document.createElement('div');
                div.textContent = str;
                return div.innerHTML;
            }

            function validateEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            function validatePhone(phone) {
                const phoneRegex = /^[+]?[\d\s()-]{10,15}$/;
                return phoneRegex.test(phone);
            }

            function validateRegNumber(regNumber) {
                // Basic validation for VIT registration number format
                const regRegex = /^[0-9]{2}[A-Z]{3}[0-9]{4}$/;
                return regRegex.test(regNumber.toUpperCase());
            }

            // Rate limiting
            let lastSubmissionTime = 0;
            const SUBMISSION_COOLDOWN = 30000; // 30 seconds

            // Department selection styling
            const departmentOptions = document.querySelectorAll('.department-option');
            departmentOptions.forEach(option => {
                const radio = option.querySelector('input[type="radio"]');
                radio.addEventListener('change', function() {
                    departmentOptions.forEach(opt => opt.classList.remove('selected'));
                    if (this.checked) {
                        option.classList.add('selected');
                    }
                });
            });

            // Form submission
            recruitmentForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                // Security: Rate limiting check
                const userIP = await generateIPHash();
                if (!window.securityManager.checkRateLimit(userIP)) {
                    showError('Too many submission attempts. Please wait before trying again.');
                    return;
                }

                // Rate limiting check (legacy)
                const currentTime = Date.now();
                if (currentTime - lastSubmissionTime < SUBMISSION_COOLDOWN) {
                    showError('Please wait 30 seconds before submitting another application.');
                    return;
                }

                // Show loading state
                showLoadingState(true);

                try {
                    // Wait for Firebase to be loaded
                    if (!window.firebaseLoaded) {
                        console.log('⏳ Waiting for Firebase to load...');
                        await new Promise((resolve, reject) => {
                            const timeout = setTimeout(() => {
                                reject(new Error('Firebase loading timeout'));
                            }, 10000); // 10 second timeout
                            
                            window.addEventListener('firebaseLoaded', () => {
                                clearTimeout(timeout);
                                resolve();
                            });
                            
                            // Check if Firebase is already loaded
                            if (window.firebaseLoaded) {
                                clearTimeout(timeout);
                                resolve();
                            }
                        });
                    }
                    
                    console.log('🔥 Firebase loaded, continuing with submission...');

                    // Get form data
                    const formData = new FormData(recruitmentForm);
                    const applicationData = {};

                    // Security: Check honeypot field (bot protection)
                    const honeypotValue = formData.get('website');
                    if (!window.securityManager.validateHoneypot(honeypotValue)) {
                        // Silent fail for bots
                        showLoadingState(false);
                        return;
                    }

                    // Sanitize and validate inputs using security manager
                    for (let [key, value] of formData.entries()) {
                        // Skip honeypot field
                        if (key === 'website') continue;
                        
                        if (typeof value === 'string') {
                            // Use security manager for sanitization
                            const sanitizationType = getSanitizationType(key);
                            applicationData[key] = window.securityManager.sanitizeInput(value.trim(), sanitizationType);
                        } else {
                            applicationData[key] = value;
                        }
                    }

                    // Security: Detect suspicious activity
                    if (window.securityManager.detectSuspiciousActivity(applicationData)) {
                        showError('Suspicious content detected. Please review your submission and avoid using special characters or scripts.');
                        return;
                    }

                    // Enhanced validation using security manager
                    const validationErrors = performSecurityValidation(applicationData);
                    if (validationErrors.length > 0) {
                        showError(validationErrors.join('<br>'));
                        return;
                    }

                    // Add metadata with security fingerprinting
                    applicationData.submissionTime = new Date().toISOString();
                    applicationData.timestamp = window.firebase?.serverTimestamp ? window.firebase.serverTimestamp() : new Date();
                    applicationData.userAgent = navigator.userAgent.substring(0, 200); // Limit length
                    applicationData.applicationId = window.securityManager.generateApplicationId();
                    applicationData.ipHash = await generateIPHash(); // Privacy-friendly IP tracking
                    applicationData.browserFingerprint = window.securityUtils.generateFingerprint();
                    applicationData.sessionToken = window.securityManager.sessionToken;
                    
                    // Submit to Firebase (if configured)
                    if (window.firebase && window.firebase.db) {
                        try {
                            console.log('📤 Attempting to submit to Firebase...', {
                                projectId: window.firebase.app.options.projectId,
                                collection: 'applications',
                                dataKeys: Object.keys(applicationData),
                                timestamp: applicationData.timestamp
                            });
                            
                            const docRef = await window.firebase.addDoc(
                                window.firebase.collection(window.firebase.db, 'applications'),
                                applicationData
                            );
                            
                            console.log('✅ Firebase submission successful! Document ID:', docRef.id);
                            
                            // Log successful submission
                            window.securityManager.logSecurityEvent('FORM_SUBMISSION_SUCCESS', {
                                documentId: docRef.id,
                                applicationId: applicationData.applicationId,
                                departmentPrimary: applicationData.departmentPrimary,
                                departmentSecondary: applicationData.departmentSecondary
                            });

                            // Show success message and reset form
                            showSuccess();
                            
                            // Reset form
                            recruitmentForm.reset();
                            
                            // Clear department selections
                            const departmentOptions = document.querySelectorAll('.department-option');
                            departmentOptions.forEach(opt => opt.classList.remove('selected'));
                            
                            // Clear hidden department fields
                            document.getElementById('department-primary').value = '';
                            document.getElementById('department-secondary').value = '';
                            
                            // Trigger reset event for React component
                            window.dispatchEvent(new CustomEvent('resetDepartmentSelector'));
                            
                            // Update rate limiting
                            lastSubmissionTime = currentTime;
                            
                            return; // Success complete
                            
                        } catch (firebaseError) {
                            console.error('❌ Firebase submission error:', firebaseError);
                            console.log('Error details:', {
                                code: firebaseError.code,
                                message: firebaseError.message,
                                details: firebaseError
                            });
                            
                            // Log failed submission
                            window.securityManager.logSecurityEvent('FORM_SUBMISSION_FAILED', {
                                errorCode: firebaseError.code,
                                errorMessage: firebaseError.message
                            });
                            
                            // Show specific Firebase error or fallback to generic message
                            if (firebaseError.code === 'permission-denied') {
                                showError('Permission denied. Please check Firestore security rules.');
                            } else if (firebaseError.code === 'unavailable') {
                                showError('Firebase service unavailable. Please try again later.');
                            } else {
                                showError(`Firebase error: ${firebaseError.message}`);
                            }
                            return;
                        }
                    } else {
                        // Enhanced fallback logging
                        console.warn('🚫 Firebase not configured properly!');
                        console.log('Current Firebase state:', {
                            firebaseExists: !!window.firebase,
                            firebaseLoaded: !!window.firebaseLoaded,
                            dbExists: !!(window.firebase && window.firebase.db),
                            firebaseKeys: window.firebase ? Object.keys(window.firebase) : null
                        });
                        console.log('📋 Application data that would be submitted:', applicationData);
                        
                        showError('Firebase not configured. Please check the console for more details.');
                        return;
                    }

                } catch (error) {
                    console.error('💥 Application submission error:', error);
                    
                    // Log error
                    window.securityManager.logSecurityEvent('FORM_SUBMISSION_ERROR', {
                        errorMessage: error.message,
                        errorStack: error.stack
                    });
                    
                    showError(`An unexpected error occurred: ${error.message}`);
                } finally {
                    showLoadingState(false);
                }
            });

            // Helper function to determine sanitization type
            function getSanitizationType(fieldName) {
                switch (fieldName) {
                    case 'firstName':
                    case 'lastName':
                        return 'name';
                    case 'email':
                        return 'email';
                    case 'phone':
                        return 'phone';
                    case 'regNumber':
                        return 'regNumber';
                    case 'departmentPrimary':
                    case 'departmentSecondary':
                        return 'department';
                    case 'skills':
                    case 'motivation':
                    case 'contribution':
                        return 'text';
                    default:
                        return 'default';
                }
            }

            // Enhanced validation function using security manager
            function performSecurityValidation(applicationData) {
                const errors = [];
                
                // Define validation rules (from firebase-config.js or fallback)
                const rules = window.validationRules || {
                    firstName: { required: true, minLength: 2, maxLength: 50 },
                    lastName: { required: true, minLength: 2, maxLength: 50 },
                    email: { required: true, maxLength: 254 },
                    phone: { required: true },
                    regNumber: { required: true },
                    departmentPrimary: { required: true },
                    departmentSecondary: { required: false },
                    skills: { required: true, minLength: 10, maxLength: 1000 },
                    motivation: { required: true, minLength: 20, maxLength: 2000 }
                };

                // Validate each field using security manager
                for (const [fieldName, fieldRules] of Object.entries(rules)) {
                    if (applicationData[fieldName] !== undefined) {
                        const fieldErrors = window.securityManager.validateField(
                            applicationData[fieldName], 
                            fieldName, 
                            fieldRules
                        );
                        errors.push(...fieldErrors);
                    }
                }

                return errors;
            }

            function generateApplicationId() {
                return 'APP_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9).toUpperCase();
            }

            // Generate privacy-friendly IP hash
            async function generateIPHash() {
                try {
                    // Get approximate location without exact IP
                    const response = await fetch('https://ipapi.co/json/');
                    const data = await response.json();
                    const locationString = `${data.country_code || 'XX'}_${data.region_code || 'XX'}`;
                    
                    // Create a simple hash
                    let hash = 0;
                    for (let i = 0; i < locationString.length; i++) {
                        const char = locationString.charCodeAt(i);
                        hash = ((hash << 5) - hash) + char;
                        hash = hash & hash; // Convert to 32-bit integer
                    }
                    return hash.toString(36);
                } catch {
                    return 'unknown';
                }
            }

            // Generate browser fingerprint for security
            function generateBrowserFingerprint() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillText('Security check', 2, 2);
                
                return {
                    screen: `${screen.width}x${screen.height}`,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    language: navigator.language,
                    platform: navigator.platform.substring(0, 20), // Limit length
                    canvas: canvas.toDataURL().substring(0, 50), // Limit length
                    timestamp: Date.now()
                };
            }

            // Detect suspicious content patterns
            function detectSuspiciousContent(data) {
                const suspiciousPatterns = [
                    // SQL injection patterns
                    /(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION)\b)/i,
                    // XSS patterns - more specific
                    /<script[^>]*>.*?<\/script>/gi,
                    /javascript:\s*[^;]/i,
                    /on(load|error|click|mouse)\s*=/i,
                    // Command injection patterns
                    /(\|\||&&|;[\s]*[a-z]|\$\(.*\))/i,
                    // Path traversal patterns
                    /\.\.\/.*\.\./g,
                    // Only flag obvious spam - same character repeated 50+ times
                    /(.)\1{50,}/,
                    // Malicious URLs
                    /https?:\/\/[^\s]+\.(exe|bat|cmd|scr|vbs)/i
                ];

                for (const [field, value] of Object.entries(data)) {
                    if (typeof value === 'string' && value.length > 0) {
                        // Skip validation for test data
                        if (field === 'firstName' && value.toLowerCase() === 'test') {
                            continue;
                        }
                        
                        for (const pattern of suspiciousPatterns) {
                            if (pattern.test(value)) {
                                console.warn('Suspicious pattern detected:', { field, pattern: pattern.toString(), value: value.substring(0, 50) });
                                return true;
                            }
                        }
                    }
                }

                return false;
            }

            function showLoadingState(loading) {
                if (loading) {
                    submitBtn.disabled = true;
                    btnText.style.display = 'none';
                    loadingSpinner.style.display = 'inline-block';
                    submitBtn.style.opacity = '0.7';
                } else {
                    submitBtn.disabled = false;
                    btnText.style.display = 'inline-block';
                    loadingSpinner.style.display = 'none';
                    submitBtn.style.opacity = '1';
                }
            }

            function showSuccess() {
                formMessages.style.display = 'block';
                successMessage.style.display = 'block';
                errorMessage.style.display = 'none';
                
                // Scroll to message
                formMessages.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Hide after 5 seconds
                setTimeout(() => {
                    formMessages.style.display = 'none';
                    successMessage.style.display = 'none';
                }, 5000);
            }

            function showError(message) {
                formMessages.style.display = 'block';
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
                errorMessage.querySelector('p').innerHTML = message;
                
                // Scroll to message
                formMessages.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Hide after 5 seconds
                setTimeout(() => {
                    formMessages.style.display = 'none';
                    errorMessage.style.display = 'none';
                }, 5000);
            }

            // Security: Disable right-click on form (basic protection)
            recruitmentForm.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });

            // Security: Disable copy/paste on sensitive fields
            const sensitiveFields = ['regNumber', 'phone'];
            sensitiveFields.forEach(fieldName => {
                const field = document.getElementById(fieldName);
                if (field) {
                    field.addEventListener('paste', function(e) {
                        e.preventDefault();
                    });
                }
            });
        });
    </script>
</body>
</html>